angular.module("contenteditable",[]).directive("contenteditable",["$timeout",function(e){return{restrict:"A",require:"?ngModel",link:function(t,n,r,a){if(a){var l={};angular.forEach(["stripBr","noLineBreaks","selectNonEditable","moveCaretToEndOnChange"],function(e){var t=r[e];l[e]=t&&"false"!==t}),n.bind("input",function(){t.$apply(function(){var t,r,i;t=n.html(),i=!1,l.stripBr&&(t=t.replace(/<br>$/,"")),l.noLineBreaks&&(r=t.replace(/<div>/g,"").replace(/<br>/g,"").replace(/<\/div>/g,""),r!==t&&(i=!0,t=r)),a.$setViewValue(t),i&&a.$render(),""===t&&e(function(){n[0].blur(),n[0].focus()})})});var i=a.$render;a.$render=function(){var e,t,r,o;i&&i(),n.html(a.$viewValue||""),l.moveCaretToEndOnChange&&(e=n[0],r=document.createRange(),o=window.getSelection(),e.childNodes.length>0?(t=e.childNodes[e.childNodes.length-1],r.setStartAfter(t)):r.setStartAfter(e),r.collapse(!0),o.removeAllRanges(),o.addRange(r))},l.selectNonEditable&&n.bind("click",function(e){var t,n,r;r=e.toElement,r!==this&&"false"===angular.element(r).attr("contenteditable")&&(t=document.createRange(),n=window.getSelection(),t.setStartBefore(r),t.setEndAfter(r),n.removeAllRanges(),n.addRange(t))})}}}}]);
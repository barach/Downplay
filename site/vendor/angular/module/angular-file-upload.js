!function(){var e=angular.module("angularFileUpload",[]);e.service("$upload",["$http","$timeout",function(e,r){function n(n){n.method=n.method||"POST",n.headers=n.headers||{},n.transformRequest=n.transformRequest||function(r,n){return window.ArrayBuffer&&r instanceof window.ArrayBuffer?r:e.defaults.transformRequest[0](r,n)},window.XMLHttpRequest.__isShim&&(n.headers.__setXHR_=function(){return function(e){n.__XHR=e,n.xhrFn&&n.xhrFn(e),e.upload.addEventListener("progress",function(e){n.progress&&r(function(){n.progress&&n.progress(e)})},!1),e.upload.addEventListener("load",function(e){e.lengthComputable&&r(function(){n.progress&&n.progress(e)})},!1)}});var t=e(n);return t.progress=function(e){return n.progress=e,t},t.abort=function(){return n.__XHR&&r(function(){n.__XHR.abort()}),t},t.xhr=function(e){return n.xhrFn=e,t},t.then=function(e,r){return function(t,a,o){n.progress=o||n.progress;var i=r.apply(e,[t,a,o]);return i.abort=e.abort,i.progress=e.progress,i.xhr=e.xhr,i}}(t,t.then),t}this.upload=function(r){r.headers=r.headers||{},r.headers["Content-Type"]=void 0,r.transformRequest=r.transformRequest||e.defaults.transformRequest;var t=new FormData,a=r.transformRequest,o=r.data;return r.transformRequest=function(e,n){if(o)if(r.formDataAppender)for(var t in o){var i=o[t];r.formDataAppender(e,t,i)}else for(var t in o){var i=o[t];if("function"==typeof a)i=a(i,n);else for(var s=0;s<a.length;s++){var f=a[s];"function"==typeof f&&(i=f(i,n))}e.append(t,i)}if(null!=r.file){var u=r.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(r.file))for(var l="[object String]"===Object.prototype.toString.call(u),s=0;s<r.file.length;s++)e.append(l?u+s:u[s],r.file[s],r.file[s].name);else e.append(u,r.file,r.file.name)}return e},r.data=t,n(r)},this.http=function(e){return n(e)}}]),e.directive("ngFileSelect",["$parse","$timeout",function(e,r){return function(n,t,a){var o=e(a.ngFileSelect);t.bind("change",function(e){var t,a,i=[];if(t=e.target.files,null!=t)for(a=0;a<t.length;a++)i.push(t.item(a));r(function(){o(n,{$files:i,$event:e})})}),t.bind("click",function(){this.value=null})}}]),e.directive("ngFileDropAvailable",["$parse","$timeout",function(e,r){return function(n,t,a){if("draggable"in document.createElement("span")){var o=e(a.ngFileDropAvailable);r(function(){o(n)})}}}]),e.directive("ngFileDrop",["$parse","$timeout",function(e,r){return function(n,t,a){function o(e,r){if(r.isDirectory){var n=r.createReader();f++,n.readEntries(function(r){for(var n=0;n<r.length;n++)o(e,r[n]);f--})}else f++,r.file(function(r){f--,e.push(r)})}if("draggable"in document.createElement("span")){var i=null,s=e(a.ngFileDrop);t[0].addEventListener("dragover",function(e){r.cancel(i),e.stopPropagation(),e.preventDefault(),t.addClass(a.ngFileDragOverClass||"dragover")},!1),t[0].addEventListener("dragleave",function(){i=r(function(){t.removeClass(a.ngFileDragOverClass||"dragover")})},!1);var f=0;t[0].addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),t.removeClass(a.ngFileDragOverClass||"dragover");var i=[],u=e.dataTransfer.items;if(u&&u.length>0&&u[0].webkitGetAsEntry)for(var l=0;l<u.length;l++)o(i,u[l].webkitGetAsEntry());else{var c=e.dataTransfer.files;if(null!=c)for(var l=0;l<c.length;l++)i.push(c.item(l))}!function d(t){r(function(){f?d(10):s(n,{$files:i,$event:e})},t||0)}()},!1)}}}])}();